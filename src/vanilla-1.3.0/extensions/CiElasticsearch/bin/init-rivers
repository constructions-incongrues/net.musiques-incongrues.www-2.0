#!/bin/sh

# Elasticsearch server URL
# eg. localhost:9200
ESHOST=$1

# Discussions river
echo ">> Discussions river"
curl -XDELETE "$ESHOST/_river/mi-discussion"
curl -XPUT "$ESHOST/_river/mi-discussion/_meta" -d '{ "type" : "jdbc", "jdbc" : { "driver" : "com.mysql.jdbc.Driver", "url" : "jdbc:mysql://localhost:3306/net_musiquesincongrues_www", "user" : "root", "password" : "", "sql" : "select * from LUM_Discussion" },  "index" : { "index" : "mi-discussion", "type" : "jdbc" } }'
echo

# Comments river
echo ">> Comments river"
curl -XDELETE "$ESHOST/_river/mi-comment"
curl -XPUT "$ESHOST/_river/mi-comment/_meta" -d '{ "type" : "jdbc", "jdbc" : { "driver" : "com.mysql.jdbc.Driver", "url" : "jdbc:mysql://localhost:3306/net_musiquesincongrues_www", "user" : "root", "password" : "", "sql" : "select * from LUM_Comment" },  "index" : { "index" : "mi-comment", "type" : "jdbc" } }'
echo

# Users river
echo ">> Users river"
curl -XDELETE "$ESHOST/_river/mi-user"
curl -XPUT "$ESHOST/_river/mi-user/_meta" -d '{ "type" : "jdbc", "jdbc" : { "driver" : "com.mysql.jdbc.Driver", "url" : "jdbc:mysql://localhost:3306/net_musiquesincongrues_www", "user" : "root", "password" : "", "sql" : "select * from LUM_User" },  "index" : { "index" : "mi-user", "type" : "jdbc" } }'
echo